<!DOCTYPE html><html lang="en-za"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ECS - Monitor container-level CPU and memory using Docker stats and CloudWatch metrics - DevCloud</title><meta name="description" content=" When using ECS, you run containers in the form of an ECS task, where each task can contain one or more container definitions, up to a maximum of 10. If you want to monitor the performance of your tasks, you can monitor the containers&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://devcloud.co.za/ecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics/"><link rel="alternate" type="application/atom+xml" href="https://devcloud.co.za/feed.xml"><link rel="alternate" type="application/json" href="https://devcloud.co.za/feed.json"><meta property="og:title" content="ECS - Monitor container-level CPU and memory using Docker stats and CloudWatch metrics"><meta property="og:image" content="https://devcloud.co.za/media/posts/13/check-the-version-with-fixes-link-in-description-29-638.jpg"><meta property="og:site_name" content="DevCloud"><meta property="og:description" content=" When using ECS, you run containers in the form of an ECS task, where each task can contain one or more container definitions, up to a maximum of 10. If you want to monitor the performance of your tasks, you can monitor the containers&hellip;"><meta property="og:url" content="https://devcloud.co.za/ecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://devcloud.co.za/media/website/cloud-icon-2.png" type="image/x-icon"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--post-entry-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://devcloud.co.za/assets/css/style.css?v=359625d231b3348c4c1f3090ac60cb1f"><link rel="stylesheet" href="https://devcloud.co.za/assets/css/photoswipe.css?v=ffb247881cd6f611d007fd4a96b7b16a"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://devcloud.co.za/ecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics/"},"headline":"ECS - Monitor container-level CPU and memory using Docker stats and CloudWatch metrics","datePublished":"2020-08-18T17:39","dateModified":"2020-10-08T17:59","image":{"@type":"ImageObject","url":"https://devcloud.co.za/media/posts/13/check-the-version-with-fixes-link-in-description-29-638.jpg","height":466,"width":638},"description":" When using ECS, you run containers in the form of an ECS task, where each task can contain one or more container definitions, up to a maximum of 10. If you want to monitor the performance of your tasks, you can monitor the containers&hellip;","author":{"@type":"Person","name":"Jenade Moodley"},"publisher":{"@type":"Organization","name":"Jenade Moodley"}}</script><style>.pswp--svg .pswp__button,
				          .pswp--svg .pswp__button--arrow--left:before,
				          .pswp--svg .pswp__button--arrow--right:before {
					          background-image: url(https://devcloud.co.za/assets/svg/gallery-icons-light.svg);
			              }</style></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://devcloud.co.za/">DevCloud</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li class="active-parent has-submenu"><span class="is-separator" aria-haspopup="true">AWS Cloud</span><ul class="navbar__submenu level-2" aria-hidden="true"><li class="has-submenu"><span class="is-separator" aria-haspopup="true">EC2</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/diagnosing-ec2-performance-issues/" target="_self">Diagnosing EC2 Performance Issues</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">EFS</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/improving-efs-performance-part-1/" target="_self">Why is my EFS slow?</a></li><li><a href="https://devcloud.co.za/improving-efs-performance-part-2/" target="_self">Improving EFS Performance</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">ECR</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/how-does-the-docker-client-authenticate-to-ecr/" target="_self">How does the Docker client authenticate to ECR?</a></li></ul></li><li class="active-parent has-submenu"><span class="is-separator" aria-haspopup="true">ECS</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/ecs-dynamic-port-mapping/" target="_self">Dynamic Port Mapping</a></li><li class="active"><a href="https://devcloud.co.za/ecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics/" target="_self">Container-level monitoring with Docker stats</a></li><li><a href="https://devcloud.co.za/how-to-store-ecs-stopped-task-details/" target="_self">Storing Stopped ECS Task Details</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">ELB</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/understanding-alb-least-outstanding-request/" target="_self">ALB - Least Outstanding Requests</a></li></ul></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Linux</span><ul class="navbar__submenu level-2" aria-hidden="true"><li class="has-submenu"><span class="is-separator" aria-haspopup="true">NFS</span><ul class="navbar__submenu level-3" aria-hidden="true"><li><a href="https://devcloud.co.za/the-nfs-buffer-cache/" target="_self">NFS Buffer Cache</a></li></ul></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">About</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://devcloud.co.za/about-me/" target="_self">About Me</a></li><li><a href="https://devcloud.co.za/about-this-website/" target="_self">About this Site</a></li></ul></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2022-02-11T00:01">February 11, 2022</time></div><div class="infobar__search"><form action="https://devcloud.co.za/search.html"><input type="search" name="q" placeholder="search..." aria-label="Search input"> <button type="submit" aria-label="Submit"><svg role="presentation" focusable="false" width="15px" height="14px"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#search"/></svg></button></form></div></div><main class="main"><article class="post"><figure class="post__featured-image"><img src="https://devcloud.co.za/media/posts/13/check-the-version-with-fixes-link-in-description-29-638.jpg" srcset="https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-xs.jpg 300w, https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-sm.jpg 480w, https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-md.jpg 768w, https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-lg.jpg 1024w, https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-xl.jpg 1360w, https://devcloud.co.za/media/posts/13/responsive/check-the-version-with-fixes-link-in-description-29-638-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="466" width="638" alt=""></figure><header class="u-header post__header"><h1>ECS - Monitor container-level CPU and memory using Docker stats and CloudWatch metrics</h1><div class="u-header__meta u-small"><img src="https://devcloud.co.za/media/website/39186496_1809180909164306_8750795900512632832_o.jpg" loading="eager" class="u-header__avatar" alt="Jenade Moodley" height="1439" width="1440"><div><a href="https://devcloud.co.za/authors/jenade-moodley/" title="Jenade Moodley">Jenade Moodley</a> <time datetime="2020-08-18T17:39">August 18, 2020 </time><a href="https://devcloud.co.za/blog/ecs/" class="u-tag u-tag--1">ECS</a></div></div></header><div class="post__entry u-inner"><p>When using ECS, you run containers in the form of an ECS task, where each task can contain one or more container definitions, up to a maximum of 10. If you want to monitor the performance of your tasks, you can monitor the containers at the task level. This does offer good insight into the working of your task, but it doesn't allow you to view the performance of each container. In a delicate environment where you need to monitor each and every aspect of the system, monitoring each container would be extremely beneficial. There is no CloudWatch metric which monitors container-level resource usage, but it is possible to build our own CloudWatch metric using the container-level resource usage statistics provided by the Docker daemon on the EC2 host. These statistics are obtained by the more widely known <code>docker stats</code> command.</p><p>The <code>docker stats</code> command returns a live data stream for running containers. With this command, you would be able to obtain the CPU, memory, network I/O, as well as disk I/O usage of each container. For this post, I will only be covering CPU and memory usage. You can take a more detailed look at <code>docker stats</code> from <a href="https://docs.docker.com/engine/reference/commandline/stats/" target="_blank">Docker's documentation</a>.</p><p>To provide a short overview of the steps we will be deploying, we will first create a script which obtains the resource usage statistics using <code>docker stats</code>, and upload these values to CloudWatch metrics. The statistics obtained will need to be easily obtained and parsed, hence the statistics will be obtained as a <code>JSON</code>, and be parsed using <code>jq</code> (more on this below). This script needs to be run at set intervals in order to gain a good understanding of the container resource usage patterns. To do this, we will create a cron job which will run this script at a set frequency.</p><h2 id="installing-the-dependencies">Installing the dependencies</h2><p>As we will be sending the metrics to CloudWatch, and parsing through the <code>JSON</code> statistics using <code>jq</code>, we need to install the AWS CLI, as well as the <code>jq</code> binary. As you are using ECS, you would most likely be using the ECS-optimized AMI, which is based on Amazon Linux, or Amazon Linux 2. As such, the commands you would use to install these dependencies would be as below:</p><pre class="line-numbers language-bash"><code>sudo yum install python3 python3-pip jq -y
sudo pip3 install -U awscli</code></pre><h2 id="creating-the-script">Creating the script</h2><p>Let's first look at the commands which will be included in the script.</p><p>We first need to obtain the resource usage statistics using <code>docker stats</code>. By default,<code>docker stats</code> is presented as text, which is not very easy to handle when trying to filter for specific values. As such, we can format the statistics into a <code>JSON</code> using the <code>--format</code> parameter. This will be based on a publicly available example <a href="https://gist.github.com/KyleBanks/8befbf0ae0d0535fa27d33cb67b40bd1" target="_blank">docker-stats-json</a>. The statistics will then be formed into a valid <code>JSON</code> object using <code>jq</code>.</p><pre class="line-numbers language-bash"><code>STATS=$(docker stats --no-stream --format "{\"container\": \"{{ .Container }}\",\"name\": \"{{ .Name }}\", \"memory\": { \"raw\": \"{{ .MemUsage }}\", \"percent\": \"{{ .MemPerc }}\"}, \"cpu\": \"{{ .CPUPerc }}\"}" | jq '.' -s -c )</code></pre><p>As we will be uploading the data to CloudWatch metrics, CloudWatch is region-specific. As such we also need to include the region in our script. We can obtain the region programmatically from the metadata service.</p><pre class="line-numbers language-bash"><code>REGION=$(curl http://169.254.169.254/latest/meta-data/placement/region 2&gt; /dev/null)</code></pre><p>We also need a way to identify and structure our metrics in CloudWatch. One good way to manage this is to use the EC2 instance ID as a dimension for the metric, as well as the Container Name, and Container ID. This will allow us to identify the exact container which provided the metric. As such, we first need the EC2 instance ID, which can also be obtained from the instance metadata.</p><pre class="line-numbers language-bash"><code>INSTANCE_ID=$(curl http://169.254.169.254/latest/meta-data/instance-id 2&gt; /dev/null)</code></pre><p>Finally, we need to parse through the JSON to obtain the Container Name, Container ID, CPU, and Memory usage of each container. To do this we first need to obtain the total number of containers.</p><pre class="line-numbers language-bash"><code>NUM_CONTAINERS=$(echo "$STATS" | jq '. | length')</code></pre><p>We then iterate through the JSON to obtain the values we need.</p><pre class="line-numbers language-bash"><code>for (( i=0; i&lt;$NUM_CONTAINERS; i++ )) 
do CPU=$(echo "$STATS" | jq -r .[$i].cpu | sed 's/%//')
MEMORY=$(echo "$STATS" | jq -r .[$i].memory.percent | sed 's/%//')
CONTAINER=$(echo $STATS | jq -r .[$i].container)
CONTAINER_NAME=$(echo $STATS | jq -r .[$i].name)</code></pre><p>And then upload these values to CloudWatch metrics using the AWS CLI.</p><pre class="line-numbers language-bash"><code>/usr/local/bin/aws cloudwatch put-metric-data --metric-name CPU --namespace DockerStats --unit Percent --value $CPU --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION
/usr/local/bin/aws cloudwatch put-metric-data --metric-name Memory --namespace DockerStats --unit Percent --value $MEMORY --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION
done</code></pre><p>Putting it all together, the completed script should look as below.</p><pre class="line-numbers language-bash"><code>#!/bin/bash

REGION=$(curl http://169.254.169.254/latest/meta-data/placement/region 2&gt; /dev/null)
INSTANCE_ID=$(curl http://169.254.169.254/latest/meta-data/instance-id 2&gt; /dev/null)
STATS=$(docker stats --no-stream --format "{\"container\": \"{{ .Container }}\",\"name\": \"{{ .Name }}\", \"memory\": { \"raw\": \"{{ .MemUsage }}\", \"percent\": \"{{ .MemPerc }}\"}, \"cpu\": \"{{ .CPUPerc }}\"}" | jq '.' -s -c )
NUM_CONTAINERS=$(echo "$STATS" | jq '. | length')

for (( i=0; i&lt;$NUM_CONTAINERS; i++ )) 
do CPU=$(echo "$STATS" | jq -r .[$i].cpu | sed 's/%//')
MEMORY=$(echo "$STATS" | jq -r .[$i].memory.percent | sed 's/%//')
CONTAINER=$(echo $STATS | jq -r .[$i].container)
CONTAINER_NAME=$(echo $STATS | jq -r .[$i].name)

/usr/local/bin/aws cloudwatch put-metric-data --metric-name CPU --namespace DockerStats --unit Percent --value $CPU --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION
/usr/local/bin/aws cloudwatch put-metric-data --metric-name Memory --namespace DockerStats --unit Percent --value $MEMORY --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION

done</code></pre><h2 id="creating-the-cron-job">Creating the Cron job</h2><p>For the sake of simplicity, I have placed the above script at&nbsp;<code>/opt/docker-stats-monitor/monitor.sh</code> in my EC2 instance.</p><p>We first need to make the above script executable.</p><pre class="line-numbers language-bash"><code>chmod +x /opt/docker-stats-monitor/monitor.sh</code></pre><p>We then need to create the cron job by creating a file in /etc/cron.d.</p><pre class="line-numbers language-bash"><code>echo '* * * * * root bash /opt/docker-stats-monitor/monitor.sh' &gt; /etc/cron.d/docker-stats</code></pre><p>The above example creates a cron job which obtains and uploads the resource-usage statistics every minute. You can adjust the frequency by changing the <a href="https://crontab.guru/" target="_blank">cron schedule expression</a>.</p><h2 id="the-results">The Results</h2><div class="gallery-wrapper gallery-wrapper--center"><div class="gallery" data-columns="3"><figure class="gallery__item"><a href="https://devcloud.co.za/media/posts/13/gallery/Annotation-2020-08-18-184055.jpg" data-size="1454x577"><img loading="lazy" src="https://devcloud.co.za/media/posts/13/gallery/Annotation-2020-08-18-184055-thumbnail.jpg" height="286" width="720" alt=""></a><figcaption>Docker stats as CloudWatch Metrics</figcaption></figure></div></div><h2 id="automating-the-procedure">Automating the Procedure</h2><p>When using ECS, you would hardly access the EC2 host, if at all. You would also most likely be incorporating Auto Scaling or Capacity Providers to launch the EC2 instance, hence you cannot SSH into each instance to configure this setup. To make this a plausible solution, you can implement the above steps using a <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html" target="_blank">User Data script</a>.</p><pre class="line-numbers language-bash"><code>#!/bin/bash

yum install python3 python3-pip jq -y
pip3 install -U awscli

mkdir -p /opt/docker-stats-monitor

cat &gt; /opt/docker-stats-monitor/monitor.sh &lt;&lt; 'EOF'
#!/bin/bash

REGION=$(curl http://169.254.169.254/latest/meta-data/placement/region 2&gt; /dev/null)

INSTANCE_ID=$(curl http://169.254.169.254/latest/meta-data/instance-id 2&gt; /dev/null)

STATS=$(docker stats --no-stream --format "{\"container\": \"{{ .Container }}\",\"name\": \"{{ .Name }}\", \"memory\": { \"raw\": \"{{ .MemUsage }}\", \"percent\": \"{{ .MemPerc }}\"}, \"cpu\": \"{{ .CPUPerc }}\"}" | jq '.' -s -c )

NUM_CONTAINERS=$(echo "$STATS" | jq '. | length')

for (( i=0; i&lt;$NUM_CONTAINERS; i++ )) 
do CPU=$(echo "$STATS" | jq -r .[$i].cpu | sed 's/%//')
MEMORY=$(echo "$STATS" | jq -r .[$i].memory.percent | sed 's/%//')
CONTAINER=$(echo $STATS | jq -r .[$i].container)
CONTAINER_NAME=$(echo $STATS | jq -r .[$i].name)

/usr/local/bin/aws cloudwatch put-metric-data --metric-name CPU --namespace DockerStats --unit Percent --value $CPU --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION

/usr/local/bin/aws cloudwatch put-metric-data --metric-name Memory --namespace DockerStats --unit Percent --value $MEMORY --dimensions InstanceId=$INSTANCE_ID,ContainerId=$CONTAINER,ContainerName=$CONTAINER_NAME --region $REGION

done
EOF

chmod +x /opt/docker-stats-monitor/monitor.sh

echo '* * * * * root bash /opt/docker-stats-monitor/monitor.sh' &gt; /etc/cron.d/docker-stats</code></pre><h2 id="conclusion">Conclusion</h2><p>This is a feasible solution for monitoring Docker containers, however one big caveat which you would have noticed is that this solution requires running commands on the EC2 host used for running the containers. This means that this solution can only work for tasks using the EC2 Launch Type, and will not work for Fargate tasks.</p><p>And that's all there is to it. Let me know your thoughts in the comments below, and feel free to adjust these steps to meet your use-case, and share with the rest of the community.</p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on October 8, 2020</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevcloud.co.za%2Fecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fdevcloud.co.za%2Fecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics%2F&amp;via=DevCloud&amp;text=ECS%20-%20Monitor%20container-level%20CPU%20and%20memory%20using%20Docker%20stats%20and%20CloudWatch%20metrics" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fdevcloud.co.za%2Fecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics%2F&amp;media=https%3A%2F%2Fdevcloud.co.za%2Fmedia%2Fposts%2F13%2Fcheck-the-version-with-fixes-link-in-description-29-638.jpg&amp;description=ECS%20-%20Monitor%20container-level%20CPU%20and%20memory%20using%20Docker%20stats%20and%20CloudWatch%20metrics" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer" aria-label="Share with Pinterest"><svg class="u-icon"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://wa.me/?text=ECS%20-%20Monitor%20container-level%20CPU%20and%20memory%20using%20Docker%20stats%20and%20CloudWatch%20metrics https%3A%2F%2Fdevcloud.co.za%2Fecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer" title="Share with WhatsApp" aria-label="Share with WhatsApp"><svg class="u-icon"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#whatsapp"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdevcloud.co.za%2Fecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer" aria-label="Share with LinkedIn"><svg class="u-icon"><use xlink:href="https://devcloud.co.za/assets/svg/svg-map.svg#linkedin"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://devcloud.co.za/blog/aws/" class="u-tag u-tag--1" title="AWS">AWS</a></li><li><a href="https://devcloud.co.za/blog/docker/" class="u-tag u-tag--1" title="Docker">Docker</a></li><li><a href="https://devcloud.co.za/blog/ecs/" class="u-tag u-tag--1" title="ECS">ECS</a></li></ul><div class="post__bio box"><img class="u-author__avatar" src="https://devcloud.co.za/media/website/39186496_1809180909164306_8750795900512632832_o.jpg" loading="lazy" alt="Jenade Moodley" height="1439" width="1440"><div><h4 class="h6"><a href="https://devcloud.co.za/authors/jenade-moodley/" title="Jenade Moodley">Jenade Moodley</a></h4><p>Hi there. I&#x27;m a Cloud Engineer, currently working at AWS. I have a background in Computer Science, and gained reputable experience with Linux, Containers, and Cloud Architecture</p></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://devcloud.co.za/about-me/" class="post__nav__link" rel="prev"><img src="https://devcloud.co.za/media/posts/12/responsive/wificoffeelaptop-1280x720-2-xs.jpg" loading="lazy" alt="" height="720" width="1280"><div class="u-small">Previous Post<h5>About Me</h5></div></a></div><div class="post__nav__next"><a href="https://devcloud.co.za/how-to-store-ecs-stopped-task-details/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>How to store ECS Stopped Task Details</h5></div><img src="https://devcloud.co.za/media/posts/14/responsive/df8a5c58-68a2-4f99-bc4d-3e080890d13a-xs.jpg" loading="lazy" alt="" height="619" width="1050"></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related-wrap"><figure class="post__related-item"><a href="https://devcloud.co.za/how-does-the-docker-client-authenticate-to-ecr/" class="c-card__image"><img src="https://devcloud.co.za/media/posts/16/responsive/ECR-Docker2-xs.png" loading="lazy" height="1473" width="3453" alt=""></a><figcaption><h4 class="post__related-title"><a href="https://devcloud.co.za/how-does-the-docker-client-authenticate-to-ecr/" class="inverse">How does the Docker client authenticate to ECR?</a></h4><time datetime="2022-02-10T16:27" class="u-small">February 10, 2022</time></figcaption></figure></div></div></footer></article><div class="comments box"><h3 class="box__title">Comments</h3><div id="disqus_thread"></div><script>var disqus_config = function () {
                    this.page.url = 'https://devcloud.co.za/ecs-monitor-container-level-cpu-and-memory-using-docker-stats-and-cloudwatch-metrics/';
                    this.page.identifier = '13';
                };
                var disqus_element_to_check = document.getElementById('disqus_thread');
            
                if ('IntersectionObserver' in window) {
                    var iObserver = new IntersectionObserver(
                        (entries, observer) => {
                            entries.forEach(entry => {
                                if (entry.intersectionRatio >= 0.1) {
                                    (function () {
                                        var d = document, s = d.createElement('script');
                                        s.src = 'https://'+'devcloud-co-za'.trim()+'.disqus.com/embed.js';
                                        s.setAttribute('data-timestamp', +new Date());
                                        (d.head || d.body).appendChild(s);
                                    })();
                                    observer.unobserve(entry.target);
                                }
                            });
                        },
                        {
                            threshold: [0, 1]
                        }
                    );
            
                    iObserver.observe(disqus_element_to_check);
                } else {
                    (function () {
                        var d = document, s = d.createElement('script');
                        s.src = 'https://'+'devcloud-co-za'.trim()+'.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                }</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></main><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured</h3><ul class="featured__container"><li class="featured__item"><a href="https://devcloud.co.za/how-to-store-ecs-stopped-task-details/" class="featured__image-link"><img src="https://devcloud.co.za/media/posts/14/responsive/df8a5c58-68a2-4f99-bc4d-3e080890d13a-xs.jpg" class="lazyload" loading="lazy" alt="" height="619" width="619"></a><div><a href="https://devcloud.co.za/how-to-store-ecs-stopped-task-details/" class="featured__title">How to store ECS Stopped Task Details</a> <time class="u-small" datetime="2020-10-08T16:43">October 8, 2020</time></div></li><li class="featured__item"><div><a href="https://devcloud.co.za/the-nfs-buffer-cache/" class="featured__title">The NFS Buffer Cache</a> <time class="u-small" datetime="2020-07-25T16:44">July 25, 2020</time></div></li><li class="featured__item"><div><a href="https://devcloud.co.za/understanding-alb-least-outstanding-request/" class="featured__title">Understanding Least Outstanding Requests ALB Load Balancing Algorithm</a> <time class="u-small" datetime="2020-07-24T00:36">July 24, 2020</time></div></li><li class="featured__item"><a href="https://devcloud.co.za/improving-efs-performance-part-2/" class="featured__image-link"><img src="https://devcloud.co.za/media/posts/7/responsive/AWS_EFS-system_DIMq8h4-xs.jpg" class="lazyload" loading="lazy" alt="" height="624" width="624"></a><div><a href="https://devcloud.co.za/improving-efs-performance-part-2/" class="featured__title">Improving EFS Performance</a> <time class="u-small" datetime="2020-07-17T23:57">July 17, 2020</time></div></li><li class="featured__item"><a href="https://devcloud.co.za/improving-efs-performance-part-1/" class="featured__image-link"><img src="https://devcloud.co.za/media/posts/6/responsive/AWS_EFS-system_DIMq8h4-xs.jpg" class="lazyload" loading="lazy" alt="" height="624" width="624"></a><div><a href="https://devcloud.co.za/improving-efs-performance-part-1/" class="featured__title">Why is my EFS slow?</a> <time class="u-small" datetime="2020-07-16T23:10">July 16, 2020</time></div></li></ul></section><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><a href="https://devcloud.co.za/authors/jenade-moodley/" class="authors__image-link"><img src="https://devcloud.co.za/media/website/39186496_1809180909164306_8750795900512632832_o.jpg" loading="lazy" alt="Jenade Moodley" height="1439" width="1440"></a><div><a href="https://devcloud.co.za/authors/jenade-moodley/" class="authors__title">Jenade Moodley</a> <span class="u-small">Post: 11</span></div></li></ul></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://devcloud.co.za/blog/alb/">ALB</a> <span class="u-small">(2)</span></li><li><a href="https://devcloud.co.za/blog/aws/">AWS</a> <span class="u-small">(6)</span></li><li><a href="https://devcloud.co.za/blog/docker/">Docker</a> <span class="u-small">(2)</span></li><li><a href="https://devcloud.co.za/blog/ec2/">EC2</a> <span class="u-small">(1)</span></li><li><a href="https://devcloud.co.za/blog/ecr/">ECR</a> <span class="u-small">(1)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://devcloud.co.za/">DevCloud</a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright"><p>Powered by Publii</p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://devcloud.co.za/assets/js/scripts.min.js?v=bb66f1d815180573784f8434c8f0bf78"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><script defer="defer" src="https://devcloud.co.za/assets/js/photoswipe.min.js?v=017385b552f7e0d979e2e2fe6f324015"></script><script defer="defer" src="https://devcloud.co.za/assets/js/photoswipe-ui-default.min.js?v=d067f0883540b1ddda0e2c9ad1b14260"></script><script>var initPhotoSwipeFromDOM=function(gallerySelector){var parseThumbnailElements=function(el){var thumbElements=el.childNodes,numNodes=thumbElements.length,items=[],figureEl,linkEl,size,item;for(var i=0;i<numNodes;i++){figureEl=thumbElements[i];if(figureEl.nodeType!==1){continue;}
          linkEl=figureEl.children[0];size=linkEl.getAttribute('data-size').split('x');item={src:linkEl.getAttribute('href'),w:parseInt(size[0],10),h:parseInt(size[1],10)};if(figureEl.children.length>1){item.title=figureEl.children[1].innerHTML;}
          if(linkEl.children.length>0){item.msrc=linkEl.children[0].getAttribute('src');}
          item.el=figureEl;items.push(item);}
          return items;};var closest=function closest(el,fn){return el&&(fn(el)?el:closest(el.parentNode,fn));};var onThumbnailsClick=function(e){e=e||window.event;e.preventDefault?e.preventDefault():e.returnValue=false;var eTarget=e.target||e.srcElement;var clickedListItem=closest(eTarget,function(el){return(el.tagName&&el.tagName.toUpperCase()==='FIGURE');});if(!clickedListItem){return;}
          var clickedGallery=clickedListItem.parentNode,childNodes=clickedListItem.parentNode.childNodes,numChildNodes=childNodes.length,nodeIndex=0,index;for(var i=0;i<numChildNodes;i++){if(childNodes[i].nodeType!==1){continue;}
          if(childNodes[i]===clickedListItem){index=nodeIndex;break;}
          nodeIndex++;}
          if(index>=0){openPhotoSwipe(index,clickedGallery);}
          return false;};var photoswipeParseHash=function(){var hash=window.location.hash.substring(1),params={};if(hash.length<5){return params;}
          var vars=hash.split('&');for(var i=0;i<vars.length;i++){if(!vars[i]){continue;}
          var pair=vars[i].split('=');if(pair.length<2){continue;}
          params[pair[0]]=pair[1];}
          if(params.gid){params.gid=parseInt(params.gid,10);}
          return params;};var openPhotoSwipe=function(index,galleryElement,disableAnimation,fromURL){var pswpElement=document.querySelectorAll('.pswp')[0],gallery,options,items;items=parseThumbnailElements(galleryElement);options={galleryUID:galleryElement.getAttribute('data-pswp-uid'),getThumbBoundsFn:function(index){var thumbnail=items[index].el.getElementsByTagName('img')[0],pageYScroll=window.pageYOffset||document.documentElement.scrollTop,rect=thumbnail.getBoundingClientRect();return{x:rect.left,y:rect.top+pageYScroll,w:rect.width};},
          mainClass:'pswp--dark',
          preload: [1,2],
          hideAnimationDuration:200,
          showAnimationDuration:0,
          bgOpacity: 0.7,
          showHideOpacity:true,
          closeOnScroll: true,
          arrowKeys: true,
          closeEl: true,
          captionEl: true,
          fullscreenEl: true,
          zoomEl: true,
          shareEl: true,
          counterEl: true,
          arrowEl: true,
          preloaderEl: true
          };if(fromURL){if(options.galleryPIDs){for(var j=0;j<items.length;j++){if(items[j].pid==index){options.index=j;break;}}}else{options.index=parseInt(index,10)-1;}}else{options.index=parseInt(index,10);}
          if(isNaN(options.index)){return;}
          if(disableAnimation){options.showAnimationDuration=0;}
          gallery=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,items,options);gallery.init();gallery.options.escKey=true;};var galleryElements=document.querySelectorAll(gallerySelector);for(var i=0,l=galleryElements.length;i<l;i++){galleryElements[i].setAttribute('data-pswp-uid',i+1);galleryElements[i].onclick=onThumbnailsClick;}
          var hashData=photoswipeParseHash();if(hashData.pid&&hashData.gid){openPhotoSwipe(hashData.pid,galleryElements[hashData.gid-1],true,true);}};window.addEventListener('load', function () {initPhotoSwipeFromDOM('.gallery');}, false);</script><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><button class="pswp__button pswp__button--share" title="Share"></button><button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button><button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button><button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></body></html>